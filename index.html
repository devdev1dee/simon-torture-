<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tomato POV: Simon's Reckoning</title>
    <style>
        body { margin: 0; background: #0a0a0a; color: #ff4444; font-family: 'Courier New', Courier, monospace; overflow: hidden; text-align: center; }
        canvas { background: radial-gradient(circle, #222 0%, #000 100%); display: block; cursor: crosshair; }
        #ui { position: absolute; top: 20px; width: 100%; pointer-events: none; }
        #level-up { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 50px; display: none; color: white; }
    </style>
</head>
<body>

    <div id="ui">
        <h1>SIMON'S PUNISHMENT</h1>
        <p>SUCCESSFUL HITS: <span id="score">0</span> / 10</p>
    </div>
    <div id="level-up">LEVEL 2: CRUCIFIED</div>

    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreEl = document.getElementById('score');
        const levelUpEl = document.getElementById('level-up');

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let score = 0;
        let level = 1;
        let tomatoes = [];
        let splats = [];

        const simon = {
            x: canvas.width / 2,
            y: canvas.height / 2,
            targetX: canvas.width / 2,
            width: 100,
            height: 150,
            velocity: 0,
            friction: 0.8,
            accel: 2.5
        };

        class Tomato {
            constructor(targetX, targetY) {
                this.x = canvas.width / 2;
                this.y = canvas.height + 100;
                this.targetX = targetX;
                this.targetY = targetY;
                this.progress = 0;
                this.speed = 0.04; 
                this.size = 100; // Starts huge
                this.active = true;
            }

            draw() {
                ctx.font = `${this.size}px serif`;
                ctx.fillText("ðŸ…", this.x - (this.size/2), this.y);
            }

            update() {
                this.progress += this.speed;
                this.x = (canvas.width / 2) + (this.targetX - (canvas.width / 2)) * this.progress;
                this.y = (canvas.height + 100) + (this.targetY - (canvas.height + 100)) * this.progress;
                this.size = 100 * (1 - this.progress * 0.8);

                if (this.progress >= 1) {
                    this.active = false;
                    checkHit(this.targetX, this.targetY);
                }
            }
        }

        function checkHit(tx, ty) {
            const hit = tx > simon.x - 50 && tx < simon.x + 50 &&
                        ty > simon.y - 100 && ty < simon.y + 50;

            if (hit) {
                score++;
                scoreEl.innerText = score;
                splats.push({x: tx, y: ty, size: 50, life: 60});
                if (score >= 10 && level === 1) triggerLevel2();
            }
        }

        function triggerLevel2() {
            level = 2;
            levelUpEl.style.display = "block";
            setTimeout(() => levelUpEl.style.display = "none", 2000);
            simon.velocity = 0;
        }

        canvas.addEventListener('mousedown', (e) => {
            tomatoes.push(new Tomato(e.clientX, e.clientY));
        });

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Level 1: Reactive Dodging AI
            if (level === 1) {
                // Find nearest incoming tomato
                let danger = tomatoes.find(t => t.progress > 0.4 && t.progress < 0.9);
                if (danger) {
                    // Dart away from the tomato's targetX
                    if (danger.targetX > simon.x) {
                        simon.velocity -= simon.accel;
                    } else {
                        simon.velocity += simon.accel;
                    }
                }
                
                // Add some random "idle" human swaying
                simon.velocity += Math.sin(Date.now() / 500) * 0.5;

                // Physics movement
                simon.x += simon.velocity;
                simon.velocity *= simon.friction;

                // Wall bounce
                if (simon.x < 100 || simon.x > canvas.width - 100) simon.velocity *= -1;
            }

            // Draw Simon
            ctx.textAlign = "center";
            if (level === 2) {
                // The Cross
                ctx.fillStyle = "#3d2b1f";
                ctx.fillRect(simon.x - 10, simon.y - 150, 20, 250); // vertical
                ctx.fillRect(simon.x - 80, simon.y - 80, 160, 20); // horizontal
                ctx.font = "100px serif";
                ctx.fillText("ðŸ™Žâ€â™‚ï¸", simon.x, simon.y); // Simon pinned
                ctx.font = "30px sans-serif";
                ctx.fillText("ðŸ˜­", simon.x, simon.y - 110); // Crying
            } else {
                ctx.font = "120px serif";
                ctx.fillText("ðŸ™Žâ€â™‚ï¸", simon.x, simon.y); // Simon dodging
            }

            // Draw Splats (Tomato juice)
            splats.forEach((s, i) => {
                ctx.fillStyle = `rgba(255, 0, 0, ${s.life / 60})`;
                ctx.beginPath();
                ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2);
                ctx.fill();
                s.life--;
                if (s.life <= 0) splats.splice(i, 1);
            });

            // Draw Tomatoes
            tomatoes.forEach((t, i) => {
                t.draw();
                t.update();
                if (!t.active) tomatoes.splice(i, 1);
            });

            requestAnimationFrame(update);
        }

        update();
        window.addEventListener('resize', () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        });
    </script>
</body>
</html>
